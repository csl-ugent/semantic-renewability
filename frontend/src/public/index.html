<!doctype html>
<html lang="en" ng-app="srApp">
  <head>
    <meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>SR: Experiment Analysis</title>
    <link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.min.css" />
	<link rel='stylesheet' href='stylesheets/style.css' />
	<style>[ng-cloak] { display: none; }</style>
  </head>
  <body ng-cloak ng-controller='experimentController'
    style="padding-top: 0px;">
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Semantic Renewability - Analytics</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
          </ul>
        </div>
      </div>
    </nav>
    <div class="container-fluid">
      <div class="row">
        <div class="col-sm-3 col-md-2 sidebar">
          <div class="panel-group" id="accordion">
            <div class="panel panel-default">
              <div class="panel-heading">
                  <h4 class="panel-title">
                      <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne"><span class="glyphicon glyphicon-tasks">
                      </span>Experiments</a>
                  </h4>
              </div>
                <div id="collapseOne" class="panel-collapse collapse in">
                    <div class="list-group">
                        <a href="#" class="list-group-item list-group-item-action" ng-repeat="experiment in experimentData | orderBy: 'createdAt':true track by $index" ng-click="setSelectedExperiment(experiment)" ng-class="{ active: isExperimentActive(experiment)}" class='text-center'>
                            {{experiment.createdAt | date:'yyyy-MM-dd HH:mm:ss'}}
                        </a>
                    </div>
                </div>
              </div>
          </div>
        </div>
        <div ng-if="selectedExperiment != undefined" class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 row">
              <div class="container-fluid">
                  <div>
                      <h1 class="page-header">Experiment Analytics: {{ selectedExperiment.id }}</h1>
                  </div>
                  <div>
                      <div class="row">
                        <div class="col-sm-6">
                              <div class="panel panel-default">
                                <div class="panel-heading">
                                    <h4 class="panel-title">
                                        <a data-toggle="collapse" href="#collapseEleven"><span class="glyphicon glyphicon-info-sign">
                                        </span>General</a>
                                    </h4>
                                </div>
                                <div id="collapseEleven" class="panel-collapse collapse in" ng-if="selectedExperiment.analytics != undefined">
                                    <div class="list-group">
                                        <span class="list-group-item" class='text-center'>
                                          <strong>Source input:</strong> {{ selectedExperiment.analytics.analytics.general.source_input }}
                                        </span>
                                        <span class="list-group-item" class='text-center'>
                                          <strong>Source files:</strong> {{ selectedExperiment.analytics.analytics.general.source_files }}
                                        </span>
                                        <span class="list-group-item" class='text-center'>
                                          <strong>Amount of functions:</strong> {{ selectedExperiment.analytics.analytics.general.amount_functions }}
                                        </span>
                                        <span class="list-group-item" class='text-center'>
                                          <strong>Fixed functions:</strong>
                                          <pre><span ng-repeat="function in selectedExperiment.analytics.analytics.general.fixed_functions | orderBy: 'object_file':false track by $index">{{function.name + "(" + function.object_file + ")\n"}}</span></pre>
                                        </span>
                                        <span class="list-group-item" class='text-center'>
                                          <strong>Mobile functions:</strong>
                                          <pre><span ng-repeat="function in selectedExperiment.analytics.analytics.general.mobile_functions | orderBy: 'object_file':false track by $index">{{function.name + "(" + function.object_file + ")\n"}}</span></pre>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6">
                              <div class="panel panel-default">
                                <div class="panel-heading">
                                    <h4 class="panel-title">
                                        <a data-toggle="collapse" href="#collapseTwelve"><span class="glyphicon glyphicon-info-sign">
                                        </span>Mobile functions</a>
                                    </h4>
                                </div>
                                <div id="collapseTwelve" class="panel-collapse collapse in">
                                    <div class="list-group">
                                        <div class="panel panel-info" style="margin-bottom: 0px;" ng-repeat="function in selectedExperiment.analytics.analytics.functions | filter: { mobile: true } | orderBy: 'obj_file' :false track by $index">
                                              <div class="panel-heading">
                                                  <h4 class="panel-title">
                                                      <a data-toggle="collapse" href={{"#collapseAnalytic"+$index}}>
                                                      {{function.name + "(" + function.obj_file + ")"}}</a>
                                                  </h4>
                                              </div>
                                              <div id={{"collapseAnalytic"+$index}} class="panel-collapse collapse">
                                                  <div class="list-group">
                                                      <span class="list-group-item" class='text-center'>
                                                        <strong>Name:</strong> {{ function.name }}
                                                      </span>
                                                      <span class="list-group-item" class='text-center'>
                                                        <strong>Object file:</strong> {{ function.obj_file }}
                                                      </span>
                                                      <span class="list-group-item" class='text-center'>
                                                        <strong>Reasons:</strong>
                                                        <pre><span ng-repeat="reason in function.reasons">{{ reason }}</span></pre>
                                                      </span>
                                                  </div>
                                              </div>
                                            </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-sm-6">
                              <div class="panel panel-default">
                                <div class="panel-heading">
                                    <h4 class="panel-title">
                                        <a data-toggle="collapse" href="#collapseThree"><span class="glyphicon glyphicon-tasks">
                                        </span>Transformations</a>
                                    </h4>
                                </div>
                                <div id="collapseThree" class="panel-collapse collapse in">
                                    <div class="list-group">
                                        <a href="#" onclick="return false;" class="list-group-item list-group-item-action" ng-repeat="transformation in selectedExperiment.transformations | orderBy: 'createdAt':true track by $index" ng-click="setSelectedTransformation(transformation)" ng-class="{ active: isTransformationActive(transformation)}">
                                        {{transformation.version_name}}</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6">
                          <div class="panel panel-default">
                              <div class="panel-heading">
                                  <h4 class="panel-title">
                                      <a data-toggle="collapse" href="#collapseFive"><span class="glyphicon glyphicon-tasks">
                                      </span>Tests</a>
                                  </h4>
                              </div>
                              <div id="collapseFive" class="panel-collapse collapse in">
                                  <div class="list-group">
                                      <a href="#" onclick="return false;" class="list-group-item list-group-item-action" ng-repeat="test in selectedExperiment.tests | orderBy: 'createdAt':true track by $index" ng-click="setSelectedTest(test)" ng-class="{ active: isTestActive(test)}">
                                      <span class="glyphicon" ng-class="{'glyphicon-ok': checkTestSuccessful(test), 'glyphicon-remove': !checkTestSuccessful(test)}"></span>{{" B_" + test.base_version + "_M_" + test.mobile_version}}</a>
                                  </div>
                              </div>
                            </div>
                          </div>
                      </div>
                      <div class="row">
                        <div class="col-sm-6">
                          <div class="panel panel-info" ng-if="selectedExperiment.selectedTransformation != undefined">
                            <div class="panel-heading">
                                <h4 class="panel-title">
                                    <a data-toggle="collapse" href="#collapseFour"><span class="glyphicon glyphicon-info-sign">
                                    </span>Transformation Details: {{ selectedExperiment.selectedTransformation.version_name }}</a>
                                </h4>
                            </div>
                            <div id="collapseFour" class="panel-collapse collapse in">
                                <div ng-switch="selectedExperiment.selectedTransformation.transformation.type" class="list-group">
                                    <div ng-switch-when="struct_reordering">
                                      <span class="list-group-item" class='text-center'>
                                          <strong>ID:</strong> {{ selectedExperiment.selectedTransformation.id }}
                                      </span>
                                      <span class="list-group-item" class='text-center'>
                                          <strong>Date:</strong> {{ selectedExperiment.selectedTransformation.createdAt | date:'yyyy-MM-dd HH:mm:ss' }}
                                      </span>
                                      <span class="list-group-item" class='text-center'>
                                          <strong>File name:</strong> {{ selectedExperiment.selectedTransformation.transformation.file_name }}
                                      </span>
                                      <span class="list-group-item" class='text-center'>
                                          <strong>Type:</strong> {{ selectedExperiment.selectedTransformation.transformation.type }}
                                      </span>
                                      <span class="list-group-item" class='text-center'>
                                          <strong>Struct:</strong> {{ selectedExperiment.selectedTransformation.transformation.file_struct_name }}
                                      </span>
                                      <span class="list-group-item" class='text-center'>
                                          <strong>Original Field Ordering:</strong>
                                          <div class="list-group" style="margin-bottom: 0px;">
                                            <span class="list-group-item" ng-repeat="field in selectedExperiment.selectedTransformation.transformation.original.fields | orderBy: 'position' :false track by $index">
                                                  {{field.type + " " + field.name}}
                                            </span>
                                          </div>
                                      </span>
                                      <span class="list-group-item" class='text-center'>
                                          <strong>Modified Field Ordering:</strong>
                                          <div class="list-group" style="margin-bottom: 0px;">
                                            <span class="list-group-item" ng-repeat="field in selectedExperiment.selectedTransformation.transformation.modified.fields | orderBy: 'position' :false track by $index">
                                                  {{field.type + " " + field.name}}
                                            </span>
                                          </div>
                                      </span>
                                    </div>
                                    <div ng-switch-when="function_parameter_reordering">
                                      <span class="list-group-item" class='text-center'>
                                          <strong>ID:</strong> {{ selectedExperiment.selectedTransformation.id }}
                                      </span>
                                      <span class="list-group-item" class='text-center'>
                                          <strong>Date:</strong> {{ selectedExperiment.selectedTransformation.createdAt | date:'yyyy-MM-dd HH:mm:ss' }}
                                      </span>
                                      <span class="list-group-item" class='text-center'>
                                          <strong>File name:</strong> {{ selectedExperiment.selectedTransformation.transformation.file_name }}
                                      </span>
                                      <span class="list-group-item" class='text-center'>
                                          <strong>Type:</strong> {{ selectedExperiment.selectedTransformation.transformation.type }}
                                      </span>
                                      <span class="list-group-item" class='text-center'>
                                          <strong>Function:</strong> {{ selectedExperiment.selectedTransformation.transformation.file_function_name }}
                                      </span>
                                      <span class="list-group-item" class='text-center'>
                                          <strong>Original Field Ordering:</strong>
                                          <div class="list-group" style="margin-bottom: 0px;">
                                            <span class="list-group-item" ng-repeat="field in selectedExperiment.selectedTransformation.transformation.original.fields | orderBy: 'position' :false track by $index">
                                                  {{field.type + " " + field.name}}
                                            </span>
                                          </div>
                                      </span>
                                      <span class="list-group-item" class='text-center'>
                                          <strong>Modified Field Ordering:</strong>
                                          <div class="list-group" style="margin-bottom: 0px;">
                                            <span class="list-group-item" ng-repeat="field in selectedExperiment.selectedTransformation.transformation.modified.fields | orderBy: 'position' :false track by $index">
                                                  {{field.type + " " + field.name}}
                                            </span>
                                          </div>
                                      </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                      </div>
                        <div class="col-sm-6">
                          <div class="panel" ng-if="selectedExperiment.selectedTest != undefined" ng-class="{'panel-success': checkTestSuccessful(selectedExperiment.selectedTest), 'panel-danger': !checkTestSuccessful(selectedExperiment.selectedTest)}">
                            <div class="panel-heading">
                                <h4 class="panel-title">
                                    <a data-toggle="collapse" href="#collapseSix"><span class="glyphicon glyphicon-info-sign">
                                    </span>Test Details: {{"B_" + selectedExperiment.selectedTest.base_version + "_M_" + selectedExperiment.selectedTest.mobile_version}}</a>
                                </h4>
                            </div>
                            <div id="collapseSix" class="panel-collapse collapse in">
                                <div ng-switch="selectedExperiment.selectedTransformation.transformation.type" class="list-group">
                                    <div>
                                      <span class="list-group-item" class='text-center'>
                                          <strong>ID:</strong> {{ selectedExperiment.selectedTest.id }}
                                      </span>
                                      <span class="list-group-item" class='text-center'>
                                          <strong>Date:</strong> {{ selectedExperiment.selectedTest.createdAt | date:'yyyy-MM-dd HH:mm:ss' }}
                                      </span>
                                      <span class="list-group-item" class='text-center'>
                                          <strong>Base version:</strong> {{ selectedExperiment.selectedTest.base_version }}
                                      </span>
                                      <span class="list-group-item" class='text-center'>
                                          <strong>Mobile version:</strong> {{ selectedExperiment.selectedTest.mobile_version }}
                                      </span>
                                      <span class="list-group-item" class='text-center'>
                                          <strong>Tests:</strong>
                                          <div class="list-group" style="margin-top: 10px;">
                                            <div class="panel" ng-class="{'panel-success': test.correct, 'panel-danger': !test.correct}" ng-repeat="test in selectedExperiment.selectedTest.test_data.results | orderBy: 'return_code' :false track by $index">
                                              <div class="panel-heading">
                                                  <h4 class="panel-title">
                                                      <a data-toggle="collapse" href={{"#collapseTest"+$index}}>
                                                      <span class="glyphicon" ng-class="{'glyphicon-ok': test.correct, 'glyphicon-remove': !test.correct}"></span>{{"Test " + ($index+1) + ": " +  test.input }}</a>
                                                  </h4>
                                              </div>
                                              <div id={{"collapseTest"+$index}} class="panel-collapse collapse">
                                                  <div class="list-group">
                                                      <span class="list-group-item" class='text-center'>
                                                        <strong>Input:</strong><pre>{{ test.input }} </pre>
                                                      </span>
                                                      <span class="list-group-item" class='text-center'>
                                                        <strong>Output:</strong><pre>{{ test.output + '\n'}}</pre>
                                                      </span>
                                                      <span class="list-group-item" class='text-center'>
                                                        <strong>Expected:</strong><pre>{{ test.expected_output + '\n'}}</pre>
                                                      </span>
                                                      <span class="list-group-item" class='text-center'>
                                                        <strong>Return code:</strong> {{ test.return_code }}
                                                      </span>
                                                      <span class="list-group-item" class='text-center'>
                                                        <strong>Stderr:</strong> {{ test.stderr }}
                                                      </span>
                                                      <span class="list-group-item" class='text-center'>
                                                        <strong>Real time:</strong> {{ test.time.real + " seconds"}}
                                                      </span>
                                                      <span class="list-group-item" class='text-center'>
                                                          <strong>System time:</strong> {{ test.time.system + " seconds"}}
                                                      </span>
                                                      <span class="list-group-item" class='text-center'>
                                                        <strong>User time:</strong> {{ test.time.user + " seconds"}}
                                                      </span>
                                                  </div>
                                              </div>
                                            </div>
                                          </div>
                                      </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                      </div>
              </div>
        </div>

      </div>
    </div>
  </div>
	<script src="bower_components/angular/angular.js"></script>
	<script src="bower_components/angular-route/angular-route.js"></script>
    <script src="bower_components/jquery/dist/jquery.min.js"></script>
    <script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="js/app.js"></script>
  </body>
</html>